<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Inl&#39;s Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="Inl&#39;s Blog">
<meta property="og:url" content="https://owliu.github.io/index.html">
<meta property="og:site_name" content="Inl&#39;s Blog">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Ow Liu">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Inl's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.4.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Inl&#39;s Blog</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://owliu.github.io"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Mysql-表的创建与维护" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/19/Mysql-%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E7%BB%B4%E6%8A%A4/" class="article-date">
  <time class="dt-published" datetime="2021-08-19T04:34:11.000Z" itemprop="datePublished">2021-08-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/19/Mysql-%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E7%BB%B4%E6%8A%A4/">Mysql-表的创建和维护</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Mysql-表的创建和维护</p>
<hr>
<h4 id="表"><a href="#表" class="headerlink" title="表"></a>表</h4><ul>
<li>表是关系数据库的核心</li>
<li>表 =  关系</li>
<li>表是记录的集合</li>
<li>二位表格模型易于人类理解</li>
<li>MySQL默认存储引擎都是基于行(记录)存储</li>
<li>每行记录都是基于列进行组织的</li>
</ul>
<h5 id="MySQL中数据库与表之间的关系"><a href="#MySQL中数据库与表之间的关系" class="headerlink" title="MySQL中数据库与表之间的关系"></a>MySQL中数据库与表之间的关系</h5><p><img src="https://inl-1257938104.cos.ap-nanjing.myqcloud.com/1629348577(1).png" alt="mysql_schema&amp;table"></p>
<hr>
<h5 id="CREATE-TABLE-语法"><a href="#CREATE-TABLE-语法" class="headerlink" title="CREATE TABLE 语法"></a>CREATE TABLE 语法</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] tbl_name</span><br><span class="line">    (create_definition,...)</span><br><span class="line">    [table_options]</span><br><span class="line">    [partition_options]</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] tbl_name</span><br><span class="line">    [(create_definition,...)]</span><br><span class="line">    [table_options]</span><br><span class="line">    [partition_options]</span><br><span class="line">    [IGNORE <span class="operator">|</span> REPLACE]</span><br><span class="line">    [<span class="keyword">AS</span>] query_expression</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> [TEMPORARY] <span class="keyword">TABLE</span> [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] tbl_name</span><br><span class="line">    &#123; <span class="keyword">LIKE</span> old_tbl_name <span class="operator">|</span> (<span class="keyword">LIKE</span> old_tbl_name) &#125;</span><br><span class="line"></span><br><span class="line">create_definition: &#123;</span><br><span class="line">    col_name column_definition</span><br><span class="line">  <span class="operator">|</span> &#123;INDEX <span class="operator">|</span> KEY&#125; [index_name] [index_type] (key_part,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  <span class="operator">|</span> &#123;FULLTEXT <span class="operator">|</span> SPATIAL&#125; [INDEX <span class="operator">|</span> KEY] [index_name] (key_part,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  <span class="operator">|</span> [<span class="keyword">CONSTRAINT</span> [symbol]] <span class="keyword">PRIMARY</span> KEY</span><br><span class="line">      [index_type] (key_part,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  <span class="operator">|</span> [<span class="keyword">CONSTRAINT</span> [symbol]] <span class="keyword">UNIQUE</span> [INDEX <span class="operator">|</span> KEY]</span><br><span class="line">      [index_name] [index_type] (key_part,...)</span><br><span class="line">      [index_option] ...</span><br><span class="line">  <span class="operator">|</span> [<span class="keyword">CONSTRAINT</span> [symbol]] <span class="keyword">FOREIGN</span> KEY</span><br><span class="line">      [index_name] (col_name,...)</span><br><span class="line">      reference_definition</span><br><span class="line">  <span class="operator">|</span> <span class="keyword">CHECK</span> (expr)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">column_definition: &#123;</span><br><span class="line">    data_type [<span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>] [<span class="keyword">DEFAULT</span> default_value]</span><br><span class="line">      [AUTO_INCREMENT] [<span class="keyword">UNIQUE</span> [KEY]] [[<span class="keyword">PRIMARY</span>] KEY]</span><br><span class="line">      [COMMENT <span class="string">&#x27;string&#x27;</span>]</span><br><span class="line">      [<span class="keyword">COLLATE</span> collation_name]</span><br><span class="line">      [COLUMN_FORMAT &#123;FIXED <span class="operator">|</span> <span class="keyword">DYNAMIC</span> <span class="operator">|</span> <span class="keyword">DEFAULT</span>&#125;]</span><br><span class="line">      [STORAGE &#123;DISK <span class="operator">|</span> MEMORY&#125;]</span><br><span class="line">      [reference_definition]</span><br><span class="line">  <span class="operator">|</span> data_type</span><br><span class="line">      [<span class="keyword">COLLATE</span> collation_name]</span><br><span class="line">      [GENERATED ALWAYS] <span class="keyword">AS</span> (expr)</span><br><span class="line">      [VIRTUAL <span class="operator">|</span> STORED] [<span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>]</span><br><span class="line">      [<span class="keyword">UNIQUE</span> [KEY]] [[<span class="keyword">PRIMARY</span>] KEY]</span><br><span class="line">      [COMMENT <span class="string">&#x27;string&#x27;</span>]</span><br><span class="line">      [reference_definition]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">data_type:</span><br><span class="line">    (see Chapter <span class="number">11</span>, Data Types)</span><br><span class="line"></span><br><span class="line">key_part:</span><br><span class="line">    col_name [(length)] [<span class="keyword">ASC</span> <span class="operator">|</span> <span class="keyword">DESC</span>]</span><br><span class="line"></span><br><span class="line">index_type:</span><br><span class="line">    <span class="keyword">USING</span> &#123;BTREE <span class="operator">|</span> HASH&#125;</span><br><span class="line"></span><br><span class="line">index_option: &#123;</span><br><span class="line">    KEY_BLOCK_SIZE [<span class="operator">=</span>] <span class="keyword">value</span></span><br><span class="line">  <span class="operator">|</span> index_type</span><br><span class="line">  <span class="operator">|</span> <span class="keyword">WITH</span> PARSER parser_name</span><br><span class="line">  <span class="operator">|</span> COMMENT <span class="string">&#x27;string&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">reference_definition:</span><br><span class="line">    <span class="keyword">REFERENCES</span> tbl_name (key_part,...)</span><br><span class="line">      [<span class="keyword">MATCH</span> <span class="keyword">FULL</span> <span class="operator">|</span> <span class="keyword">MATCH</span> PARTIAL <span class="operator">|</span> <span class="keyword">MATCH</span> SIMPLE]</span><br><span class="line">      [<span class="keyword">ON</span> <span class="keyword">DELETE</span> reference_option]</span><br><span class="line">      [<span class="keyword">ON</span> UPDATE reference_option]</span><br><span class="line"></span><br><span class="line">reference_option:</span><br><span class="line">    RESTRICT <span class="operator">|</span> CASCADE <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NO</span> ACTION <span class="operator">|</span> <span class="keyword">SET</span> <span class="keyword">DEFAULT</span></span><br><span class="line"></span><br><span class="line">table_options:</span><br><span class="line">    table_option [[,] table_option] ...</span><br><span class="line"></span><br><span class="line">table_option: &#123;</span><br><span class="line">    AUTO_INCREMENT [<span class="operator">=</span>] <span class="keyword">value</span></span><br><span class="line">  <span class="operator">|</span> AVG_ROW_LENGTH [<span class="operator">=</span>] <span class="keyword">value</span></span><br><span class="line">  <span class="operator">|</span> [<span class="keyword">DEFAULT</span>] <span class="type">CHARACTER</span> <span class="keyword">SET</span> [<span class="operator">=</span>] charset_name</span><br><span class="line">  <span class="operator">|</span> CHECKSUM [<span class="operator">=</span>] &#123;<span class="number">0</span> <span class="operator">|</span> <span class="number">1</span>&#125;</span><br><span class="line">  <span class="operator">|</span> [<span class="keyword">DEFAULT</span>] <span class="keyword">COLLATE</span> [<span class="operator">=</span>] collation_name</span><br><span class="line">  <span class="operator">|</span> COMMENT [<span class="operator">=</span>] <span class="string">&#x27;string&#x27;</span></span><br><span class="line">  <span class="operator">|</span> COMPRESSION [<span class="operator">=</span>] &#123;<span class="string">&#x27;ZLIB&#x27;</span> <span class="operator">|</span> <span class="string">&#x27;LZ4&#x27;</span> <span class="operator">|</span> <span class="string">&#x27;NONE&#x27;</span>&#125;</span><br><span class="line">  <span class="operator">|</span> CONNECTION [<span class="operator">=</span>] <span class="string">&#x27;connect_string&#x27;</span></span><br><span class="line">  <span class="operator">|</span> &#123;DATA <span class="operator">|</span> INDEX&#125; DIRECTORY [<span class="operator">=</span>] <span class="string">&#x27;absolute path to directory&#x27;</span></span><br><span class="line">  <span class="operator">|</span> DELAY_KEY_WRITE [<span class="operator">=</span>] &#123;<span class="number">0</span> <span class="operator">|</span> <span class="number">1</span>&#125;</span><br><span class="line">  <span class="operator">|</span> ENCRYPTION [<span class="operator">=</span>] &#123;<span class="string">&#x27;Y&#x27;</span> <span class="operator">|</span> <span class="string">&#x27;N&#x27;</span>&#125;</span><br><span class="line">  <span class="operator">|</span> ENGINE [<span class="operator">=</span>] engine_name</span><br><span class="line">  <span class="operator">|</span> INSERT_METHOD [<span class="operator">=</span>] &#123; <span class="keyword">NO</span> <span class="operator">|</span> <span class="keyword">FIRST</span> <span class="operator">|</span> <span class="keyword">LAST</span> &#125;</span><br><span class="line">  <span class="operator">|</span> KEY_BLOCK_SIZE [<span class="operator">=</span>] <span class="keyword">value</span></span><br><span class="line">  <span class="operator">|</span> MAX_ROWS [<span class="operator">=</span>] <span class="keyword">value</span></span><br><span class="line">  <span class="operator">|</span> MIN_ROWS [<span class="operator">=</span>] <span class="keyword">value</span></span><br><span class="line">  <span class="operator">|</span> PACK_KEYS [<span class="operator">=</span>] &#123;<span class="number">0</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span> <span class="keyword">DEFAULT</span>&#125;</span><br><span class="line">  <span class="operator">|</span> PASSWORD [<span class="operator">=</span>] <span class="string">&#x27;string&#x27;</span></span><br><span class="line">  <span class="operator">|</span> ROW_FORMAT [<span class="operator">=</span>] &#123;<span class="keyword">DEFAULT</span> <span class="operator">|</span> <span class="keyword">DYNAMIC</span> <span class="operator">|</span> FIXED <span class="operator">|</span> COMPRESSED <span class="operator">|</span> REDUNDANT <span class="operator">|</span> COMPACT&#125;</span><br><span class="line">  <span class="operator">|</span> STATS_AUTO_RECALC [<span class="operator">=</span>] &#123;<span class="keyword">DEFAULT</span> <span class="operator">|</span> <span class="number">0</span> <span class="operator">|</span> <span class="number">1</span>&#125;</span><br><span class="line">  <span class="operator">|</span> STATS_PERSISTENT [<span class="operator">=</span>] &#123;<span class="keyword">DEFAULT</span> <span class="operator">|</span> <span class="number">0</span> <span class="operator">|</span> <span class="number">1</span>&#125;</span><br><span class="line">  <span class="operator">|</span> STATS_SAMPLE_PAGES [<span class="operator">=</span>] <span class="keyword">value</span></span><br><span class="line">  <span class="operator">|</span> TABLESPACE tablespace_name [STORAGE &#123;DISK <span class="operator">|</span> MEMORY&#125;]</span><br><span class="line">  <span class="operator">|</span> <span class="keyword">UNION</span> [<span class="operator">=</span>] (tbl_name[,tbl_name]...)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">partition_options:</span><br><span class="line">    <span class="keyword">PARTITION</span> <span class="keyword">BY</span></span><br><span class="line">        &#123; [LINEAR] HASH(expr)</span><br><span class="line">        <span class="operator">|</span> [LINEAR] KEY [ALGORITHM<span class="operator">=</span>&#123;<span class="number">1</span> <span class="operator">|</span> <span class="number">2</span>&#125;] (column_list)</span><br><span class="line">        <span class="operator">|</span> <span class="keyword">RANGE</span>&#123;(expr) <span class="operator">|</span> COLUMNS(column_list)&#125;</span><br><span class="line">        <span class="operator">|</span> LIST&#123;(expr) <span class="operator">|</span> COLUMNS(column_list)&#125; &#125;</span><br><span class="line">    [PARTITIONS num]</span><br><span class="line">    [SUBPARTITION <span class="keyword">BY</span></span><br><span class="line">        &#123; [LINEAR] HASH(expr)</span><br><span class="line">        <span class="operator">|</span> [LINEAR] KEY [ALGORITHM<span class="operator">=</span>&#123;<span class="number">1</span> <span class="operator">|</span> <span class="number">2</span>&#125;] (column_list) &#125;</span><br><span class="line">      [SUBPARTITIONS num]</span><br><span class="line">    ]</span><br><span class="line">    [(partition_definition [, partition_definition] ...)]</span><br><span class="line"></span><br><span class="line">partition_definition:</span><br><span class="line">    <span class="keyword">PARTITION</span> partition_name</span><br><span class="line">        [<span class="keyword">VALUES</span></span><br><span class="line">            &#123;LESS THAN &#123;(expr <span class="operator">|</span> value_list) <span class="operator">|</span> MAXVALUE&#125;</span><br><span class="line">            <span class="operator">|</span></span><br><span class="line">            <span class="keyword">IN</span> (value_list)&#125;]</span><br><span class="line">        [[STORAGE] ENGINE [<span class="operator">=</span>] engine_name]</span><br><span class="line">        [COMMENT [<span class="operator">=</span>] <span class="string">&#x27;string&#x27;</span> ]</span><br><span class="line">        [DATA DIRECTORY [<span class="operator">=</span>] <span class="string">&#x27;data_dir&#x27;</span>]</span><br><span class="line">        [INDEX DIRECTORY [<span class="operator">=</span>] <span class="string">&#x27;index_dir&#x27;</span>]</span><br><span class="line">        [MAX_ROWS [<span class="operator">=</span>] max_number_of_rows]</span><br><span class="line">        [MIN_ROWS [<span class="operator">=</span>] min_number_of_rows]</span><br><span class="line">        [TABLESPACE [<span class="operator">=</span>] tablespace_name]</span><br><span class="line">        [(subpartition_definition [, subpartition_definition] ...)]</span><br><span class="line"></span><br><span class="line">subpartition_definition:</span><br><span class="line">    SUBPARTITION logical_name</span><br><span class="line">        [[STORAGE] ENGINE [<span class="operator">=</span>] engine_name]</span><br><span class="line">        [COMMENT [<span class="operator">=</span>] <span class="string">&#x27;string&#x27;</span> ]</span><br><span class="line">        [DATA DIRECTORY [<span class="operator">=</span>] <span class="string">&#x27;data_dir&#x27;</span>]</span><br><span class="line">        [INDEX DIRECTORY [<span class="operator">=</span>] <span class="string">&#x27;index_dir&#x27;</span>]</span><br><span class="line">        [MAX_ROWS [<span class="operator">=</span>] max_number_of_rows]</span><br><span class="line">        [MIN_ROWS [<span class="operator">=</span>] min_number_of_rows]</span><br><span class="line">        [TABLESPACE [<span class="operator">=</span>] tablespace_name]</span><br><span class="line"></span><br><span class="line">query_expression:</span><br><span class="line">    <span class="keyword">SELECT</span> ...   (<span class="keyword">Some</span> valid <span class="keyword">select</span> <span class="keyword">or</span> <span class="keyword">union</span> statement)</span><br></pre></td></tr></table></figure>
<p>MoreInfo: <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/create-table.html">Create-table</a></p>
<hr>
<h5 id="CREATE-TABLE-–-外键约束"><a href="#CREATE-TABLE-–-外键约束" class="headerlink" title="CREATE TABLE – 外键约束"></a>CREATE TABLE – 外键约束</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[CONSTRAINT [symbol]] FOREIGN KEY</span><br><span class="line">[index name](index col name, ...)</span><br><span class="line">REFERENCES tbl name(index col name,.</span><br><span class="line">[ON DELETE reference_option]</span><br><span class="line">[ON UPDATE reference_option]</span><br><span class="line">reference option:</span><br><span class="line">RESTRICT CASCADE I SET NULL NO ACTION</span><br><span class="line">RESTRICT= NO ACTION</span><br></pre></td></tr></table></figure>
<p>外键约束示例：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> product(</span><br><span class="line">  category <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>, id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  price <span class="type">DECIMAL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY(category, id</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customer(</span><br><span class="line">  id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">)ENGINE<span class="operator">=</span>INNODB;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> customer(</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY (id)</span><br><span class="line">)   ENGINE<span class="operator">-</span>INNODB;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> product_order(</span><br><span class="line">    <span class="keyword">no</span> <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO INCREMENT</span><br><span class="line">    product category <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    product id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">    customer id <span class="type">INT</span> <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"></span><br><span class="line">    <span class="keyword">PRIMARY</span> KEY(<span class="keyword">no</span>),</span><br><span class="line">    INDEX (product_ category, product_id),</span><br><span class="line">    INDEX (customer_id),</span><br><span class="line"></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY(product_category, product_id)</span><br><span class="line">      <span class="keyword">REFERENCES</span> product(eategory, id)</span><br><span class="line">      <span class="keyword">ON</span> UPDATE CASCADE <span class="keyword">ON</span> <span class="keyword">DELETE</span> RESTRICT,</span><br><span class="line"></span><br><span class="line">    <span class="keyword">FOREIGN</span> KEY(customer id)</span><br><span class="line">      <span class="keyword">REFERENCES</span> customer(id)</span><br><span class="line">) ENGINE<span class="operator">=</span>INNODB;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/08/19/Mysql-%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E7%BB%B4%E6%8A%A4/" data-id="cksj3e1js000hm4w0b47y650z" data-title="Mysql-表的创建和维护" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-数据类型" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/17/Mysql-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="article-date">
  <time class="dt-published" datetime="2021-08-17T15:43:36.000Z" itemprop="datePublished">2021-08-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/17/Mysql-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">Mysql-数据类型</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="Mysql-数据类型"><a href="#Mysql-数据类型" class="headerlink" title="Mysql 数据类型"></a>Mysql 数据类型</h4><h4 id="int-类型"><a href="#int-类型" class="headerlink" title="int 类型"></a>int 类型</h4><p><img src="https://inl-1257938104.cos.ap-nanjing.myqcloud.com/1629216703.png" alt="int类型"></p>
<ul>
<li>int 类型的属性<ul>
<li>UNSIGNED / SIGNED<ul>
<li>是否有符号</li>
</ul>
</li>
<li>ZEROFILL<ul>
<li>显示属性</li>
<li>值不作任何修改</li>
</ul>
</li>
<li>AUTO_INCREMENT<ul>
<li>自增</li>
<li>每张表一个</li>
<li>必须是索引的一部分</li>
<li>有一个函数:last_insert_id() 返回当前会话最后插入的ID<h5 id="通常情况下AUTU-INCREMENT是不会回溯的"><a href="#通常情况下AUTU-INCREMENT是不会回溯的" class="headerlink" title="通常情况下AUTU_INCREMENT是不会回溯的"></a>通常情况下AUTU_INCREMENT是不会回溯的</h5><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">0.</span>这是一张 a 为主键 AUTO_INCREMENT 的表</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> z;</span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> a <span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"></span><br><span class="line"># <span class="number">1.</span>删除最后插入的一行 可以看到删除了自增ID为 <span class="number">5</span> 的 行</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> z <span class="keyword">where</span> a <span class="operator">=</span> last_insert_id();last_insert_id();</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> z;</span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> a <span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"># <span class="number">2.</span>再次插入记录 可以看到下面例子；删除的自增ID，是不会再重现回溯的</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> z;</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> z(b)<span class="keyword">values</span>(<span class="number">1</span>); </span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> a <span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br></pre></td></tr></table></figure>
在数据库重启后自增ID是会回溯  我们复现一下该场景，如下面示例<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># <span class="number">0.</span>这是一个自增加ID到<span class="number">6</span>的字段</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> z;</span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> a <span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">6</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"></span><br><span class="line"># <span class="number">1.</span>删除掉两条记录</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> z <span class="keyword">where</span> a <span class="operator">=</span><span class="number">5</span>;</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">delete</span> <span class="keyword">from</span> z <span class="keyword">where</span> a <span class="operator">=</span><span class="number">6</span>;</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> z;</span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> a <span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"></span><br><span class="line"># <span class="number">2.</span>重启数据库后 插入两条记录，就可以看到自增ID被回溯啦</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> z(b) <span class="keyword">values</span>(<span class="number">1</span>);</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> z(b) <span class="keyword">values</span>(<span class="number">1</span>);</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> z;</span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> a <span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">3</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">4</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">5</span> <span class="operator">|</span>    <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
究其原因是 AUTO_INCREMENT 的值是不会持久化的，如下面示例的  <strong>AUTO_INCREMENT=7</strong><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> z\G</span><br><span class="line">       <span class="keyword">Table</span>: z</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `z` (</span><br><span class="line">  `a` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `b` tinyint(<span class="number">4</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`a`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">7</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>latin1</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><strong>AUTO_INCREMENT=7</strong> 这个值是怎么来的呢？<br>是数据库在每次启动时候 <strong>AUTO_INCREMENT=7</strong>=select max(a) + 1 from z;  </p>
<p>MySQL5.7 是无法在数据库层面解决这个问题的<br>MySQL8.0 是将 AUTO_INCREMENT 的值持久化了的所以不存在这个问题 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/innodb-auto-increment-handling.html">MoreInfo</a></p>
<h5 id="INT-类型的总结"><a href="#INT-类型的总结" class="headerlink" title="INT 类型的总结"></a>INT 类型的总结</h5><ul>
<li>推荐不要使用 UNSIGNED</li>
<li>范围本质上没有大的改变</li>
<li>UNSIGED 可能会有溢出现象发生</li>
<li>自增 INT 类型主键建议使用 BIGINT</li>
</ul>
<hr>
<h4 id="数字类型"><a href="#数字类型" class="headerlink" title="数字类型"></a>数字类型</h4><ul>
<li>单精度类型:FLOAT<ul>
<li>M*G/G 不一定等于M</li>
</ul>
</li>
<li>双精度类型:DOUBLE<ul>
<li>M*G/G 不一定等于M</li>
</ul>
</li>
<li>高精度类型:DECIMAL</li>
</ul>
<p>** FLOAT(M,D) / DOUBLE(M,D) / DECIMAL(M,D) 表示显示M位整数，其中D位位于小数点后面</p>
<table>
<thead>
<tr>
<th>类型</th>
<th>占用空间</th>
<th>精度</th>
<th>准确性</th>
</tr>
</thead>
<tbody><tr>
<td>FLOAT</td>
<td>4</td>
<td>单精度</td>
<td>低</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>8</td>
<td>双精度</td>
<td>低，比FLOAT高</td>
</tr>
<tr>
<td>DECIMAL</td>
<td>变长</td>
<td>高精度</td>
<td>非常高</td>
</tr>
</tbody></table>
<p>** 财务、账务系统必须使用DECIMAL类型！！！</p>
<h5 id="数字类型的函数"><a href="#数字类型的函数" class="headerlink" title="数字类型的函数"></a>数字类型的函数</h5><ul>
<li>floor(x) 向下取整</li>
<li>round(x,y) 用于数据的四舍五入，x指要处理的数，y是指保留几位小数</li>
<li>MySQL RAND() 函数调用可以在0和1之间产生一个随机数</li>
</ul>
<hr>
<h4 id="字符串类型"><a href="#字符串类型" class="headerlink" title="字符串类型"></a>字符串类型</h4><p><img src="https://inl-1257938104.cos.ap-nanjing.myqcloud.com/1629294058(1).png" alt="字符串类型"><br>** BLOB =&gt; VARBINARY<br>** TEXT =&gt; VARCHAR</p>
<h5 id="字符串类型–函数"><a href="#字符串类型–函数" class="headerlink" title="字符串类型–函数"></a>字符串类型–函数</h5><ul>
<li>length() 返回字节长度<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># example:</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> length(<span class="string">&#x27;我&#x27;</span>);</span><br><span class="line">  <span class="operator">+</span><span class="comment">---------------+</span></span><br><span class="line">  <span class="operator">|</span> length(<span class="string">&#x27;我&#x27;</span>)  <span class="operator">|</span></span><br><span class="line">  <span class="operator">+</span><span class="comment">---------------+</span></span><br><span class="line">  <span class="operator">|</span>             <span class="number">3</span> <span class="operator">|</span></span><br><span class="line">  <span class="operator">+</span><span class="comment">---------------+</span></span><br></pre></td></tr></table></figure></li>
<li>char_length() 返回字符的长度<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="keyword">char_length</span>(<span class="string">&#x27;我&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">char_length</span>(<span class="string">&#x27;我&#x27;</span>)  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span>                  <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br></pre></td></tr></table></figure></li>
<li>upper() 将字符串转换为全大写<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">upper</span>(<span class="string">&#x27;aBc&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">upper</span>(<span class="string">&#x27;aBc&#x27;</span>)       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span>                ABC <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br></pre></td></tr></table></figure></li>
<li>lower() 将字符串转换为全小写<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">lower</span>(<span class="string">&#x27;aBc&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">lower</span>(<span class="string">&#x27;aBc&#x27;</span>)       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span>                abc <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br></pre></td></tr></table></figure></li>
<li>hex() 如果入参是个字符串，那么返回字符串16进制的值<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> hex(<span class="string">&#x27;我爱你&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> hex(<span class="string">&#x27;我爱你&#x27;</span>)      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> E68891E788B1E4BDA0 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br></pre></td></tr></table></figure></li>
<li>cast() 可以作类型转换<ul>
<li>CAST( value AS type )<h5 id="字符串类型–字符集"><a href="#字符串类型–字符集" class="headerlink" title="字符串类型–字符集"></a>字符串类型–字符集</h5></li>
</ul>
</li>
<li>character set<ul>
<li>a set Of symbols and encoding</li>
</ul>
</li>
<li>常见字符集: uft8、uft8mb4、gbk、gb18030</li>
</ul>
<p>查看 MySQL 支持的字符集</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span>  <span class="keyword">show</span> <span class="type">character</span> <span class="keyword">set</span>;</span><br><span class="line">.........</span><br></pre></td></tr></table></figure>
<p>tips:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0. Mysql 字符集不是实例级别的，它可以是表级别，甚至是列级别的</span><br><span class="line">1. 在大多数环境下 都应该设置成 character_set_server = uft8mb4</span><br></pre></td></tr></table></figure>

<h5 id="字符串类型–排序规则"><a href="#字符串类型–排序规则" class="headerlink" title="字符串类型–排序规则"></a>字符串类型–排序规则</h5><ul>
<li>collation<ul>
<li>set of rules for comparing characters in a character set</li>
</ul>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># <span class="string">&#x27;a&#x27;</span>和<span class="string">&#x27;a&#x27;</span> 相比较是相等滴</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="string">&#x27;a&#x27;</span><span class="operator">=</span><span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="string">&#x27;a&#x27;</span><span class="operator">=</span><span class="string">&#x27;a&#x27;</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="comment">--------------------------- 任性的分割线------------------------</span></span><br><span class="line"># <span class="string">&#x27;A&#x27;</span>和<span class="string">&#x27;a&#x27;</span> 相比较也是相等滴</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span><span class="operator">=</span><span class="string">&#x27;a&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="string">&#x27;A&#x27;</span><span class="operator">=</span><span class="string">&#x27;a&#x27;</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="comment">--------------------------- 任性的分割线------------------------</span></span><br><span class="line"># <span class="string">&#x27;A&#x27;</span>和<span class="string">&#x27;a  &#x27;</span> 相比较也是相等滴 </span><br><span class="line"># 因为默认的 <span class="keyword">collate</span> 是大小写不敏感的</span><br><span class="line"># 而且会忽略右边的空格</span><br><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [(<span class="keyword">none</span>)]<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="string">&#x27;A&#x27;</span><span class="operator">=</span><span class="string">&#x27;a  &#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span> <span class="string">&#x27;A&#x27;</span><span class="operator">=</span><span class="string">&#x27;a&#x27;</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br><span class="line"><span class="operator">|</span>       <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------+</span></span><br></pre></td></tr></table></figure>
<p>tips:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">0. 设置为 collate utf8mb4_bin 就对大小写敏感了</span><br><span class="line">1. 如果真的需要对空格也有比较需求，我们就只能将值存储为二进制字节 如 VARBINARY</span><br></pre></td></tr></table></figure>

<h5 id="字符串类型–ENUM-amp-SET"><a href="#字符串类型–ENUM-amp-SET" class="headerlink" title="字符串类型–ENUM &amp; SET"></a>字符串类型–ENUM &amp; SET</h5><ul>
<li><p>字符串类型 – 集合类型</p>
</li>
<li><p>ENUM类型最多允许65536个值</p>
</li>
<li><p>SET 类型最多允许64个值</p>
</li>
<li><p>通过sql_mode参数可以用于约束检查  </p>
<p><img src="https://inl-1257938104.cos.ap-nanjing.myqcloud.com/1629314291.png" alt="enum&amp;set"></p>
</li>
</ul>
<hr>
<h4 id="日期类型"><a href="#日期类型" class="headerlink" title="日期类型"></a>日期类型</h4><p><img src="https://inl-1257938104.cos.ap-nanjing.myqcloud.com/1629314793(1).png" alt="时期类型"></p>
<ul>
<li><p>MySQL-5.6.4 版本开始支持微秒</p>
</li>
<li><p>类型支持:TIME、DATETIME、TIMESTAMP</p>
</li>
<li><p>type_name(fsp) fsp最大为6  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> now(<span class="number">6</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> now(<span class="number">6</span>)                     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-19</span> <span class="number">03</span>:<span class="number">33</span>:<span class="number">01.262091</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="日期类型–日期函数"><a href="#日期类型–日期函数" class="headerlink" title="日期类型–日期函数"></a>日期类型–日期函数</h5><table>
<thead>
<tr>
<th>函数名</th>
<th>函数说明</th>
</tr>
</thead>
<tbody><tr>
<td>NOW</td>
<td>返回SQL执行时的时间</td>
</tr>
<tr>
<td>CURRENT_TIMESTAMP</td>
<td>与NOW函数同义</td>
</tr>
<tr>
<td>SYSDATE</td>
<td>返回执行函数时的时间</td>
</tr>
<tr>
<td>DATE_ADD(data,INTERVAL expr unit)</td>
<td>增加时间</td>
</tr>
<tr>
<td>DATE_SUB(data,INTERVAL expr unit)</td>
<td>减少时间</td>
</tr>
<tr>
<td>DATE_FORAT</td>
<td>格式化时间输出</td>
</tr>
</tbody></table>
<p>其中函数NOW()和SYSDATE有何区别? 举个栗子</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [test]<span class="operator">&gt;</span> <span class="keyword">select</span> NOW(),SYSDATE(),SLEEP(<span class="number">5</span>),NOW(),SYSDATE();</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+---------------------+----------+---------------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> NOW()               <span class="operator">|</span> SYSDATE()           <span class="operator">|</span> SLEEP(<span class="number">5</span>) <span class="operator">|</span> NOW()               <span class="operator">|</span> SYSDATE()           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+---------------------+----------+---------------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-19</span> <span class="number">03</span>:<span class="number">50</span>:<span class="number">08</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-19</span> <span class="number">03</span>:<span class="number">50</span>:<span class="number">08</span> <span class="operator">|</span>        <span class="number">0</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-19</span> <span class="number">03</span>:<span class="number">50</span>:<span class="number">08</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-08</span><span class="number">-19</span> <span class="number">03</span>:<span class="number">50</span>:<span class="number">13</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+---------------------+----------+---------------------+---------------------+</span></span><br></pre></td></tr></table></figure>
<p>那么~？ 有啥子区别呢？<br>讲人话就是，NOW() 返回这条SQL执行时候的时间，SYSDATE() 返回执行到函数自身时的时间</p>
<hr>
<h4 id="JSON类型"><a href="#JSON类型" class="headerlink" title="JSON类型"></a>JSON类型</h4><ul>
<li>5.7版本支持</li>
<li>更像是文档型数据库了，完全可以像mongoDB一样 Schema Free了</li>
<li>原生JSON类型替换BLOB类型<ul>
<li><p>JSON数据的有效性检查：BLOB类型无法在数据库层面做这样的约束性检查</p>
</li>
<li><p>查询性能的提升：查询不许要遍历所有的字符串才能找到数据</p>
</li>
<li><p>支持部分属性索引：通过虚拟列的功能可以对JSON中的部分数据进行索引</p>
<p><img src="https://inl-1257938104.cos.ap-nanjing.myqcloud.com/1629319489(1).png" alt="JSON数据类型"></p>
</li>
</ul>
</li>
</ul>
<h5 id="JSON类型–相关函数"><a href="#JSON类型–相关函数" class="headerlink" title="JSON类型–相关函数"></a>JSON类型–相关函数</h5><ul>
<li>json_append</li>
<li>json_contains_key</li>
<li>json_extract</li>
<li>json_merge</li>
<li>json_remove</li>
<li>json_replace</li>
<li>json_search</li>
<li>json_set</li>
<li>json_test_parser</li>
<li>json_valid  </li>
</ul>
<p><strong>这个玩意真不错，实践后面来补上吧</strong><br><strong>实例在171上的test库中的UserJson表</strong><br><strong>等待补进度</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/08/17/Mysql-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" data-id="cksj3e1jl000am4w02kat67h5" data-title="Mysql-数据类型" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-存储引擎" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/17/Mysql-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/" class="article-date">
  <time class="dt-published" datetime="2021-08-17T13:02:51.000Z" itemprop="datePublished">2021-08-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/17/Mysql-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/">Mysql-存储引擎</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>Quick Viewing  </p>
<ol>
<li><a href="#p2">慢查询日志</a></li>
<li><a href="#p2">错误日志</a></li>
</ol>
<h3 id="存储引擎的概念"><a href="#存储引擎的概念" class="headerlink" title="存储引擎的概念"></a>存储引擎的概念</h3><ul>
<li>用来处理数据库的相关 CRUD 操作</li>
<li>每个数据库都有存储引擎的概念</li>
<li>Oracle 是不特别强调存储引擎这个概念的 Mysql 同样</li>
<li>Oracle<ul>
<li>堆表</li>
<li>簇表</li>
<li>索引组织表</li>
</ul>
</li>
</ul>
<h4 id="一些常见的数据库存储引擎"><a href="#一些常见的数据库存储引擎" class="headerlink" title="一些常见的数据库存储引擎"></a>一些常见的数据库存储引擎</h4><table>
<thead>
<tr>
<th>Name</th>
<th>License</th>
<th>Transactional</th>
</tr>
</thead>
<tbody><tr>
<td>MyISAM</td>
<td>GPL</td>
<td>No</td>
</tr>
<tr>
<td>innoDB</td>
<td>GPL</td>
<td>Yes</td>
</tr>
<tr>
<td>tokuDB</td>
<td>GPL</td>
<td>YES</td>
</tr>
<tr>
<td>WiredTiger</td>
<td>GPL</td>
<td>YES</td>
</tr>
<tr>
<td>LevelDB</td>
<td>GPL</td>
<td>NO</td>
</tr>
<tr>
<td>RocksDB</td>
<td>GPL</td>
<td>YES</td>
</tr>
</tbody></table>
<h4 id="Mysql存储引擎"><a href="#Mysql存储引擎" class="headerlink" title="Mysql存储引擎"></a>Mysql存储引擎</h4><ul>
<li><p>官方存储引擎</p>
<ul>
<li><p>MyISAM</p>
<ul>
<li>MySQL5.1版本之前的默认存储引擎</li>
<li>堆表数据结构</li>
<li>表锁设计</li>
<li>支持数据静态压缩</li>
<li>不支持事务</li>
<li>数据容易丢失</li>
<li>索引容易损坏</li>
<li>相比起来唯一的优点<ul>
<li>数据文件可以直接拷贝到另外一台服务器使用</li>
</ul>
</li>
<li>MyISAM 数据文件<ul>
<li> .MYD</li>
</ul>
</li>
<li>索引文件<ul>
<li> .MYI</li>
</ul>
</li>
<li>修复错误数据表<ul>
<li>myisamchk </li>
</ul>
</li>
</ul>
</li>
<li><p>innoDB</p>
</li>
<li><p>Memory</p>
<ul>
<li>全内存存储的引擎</li>
<li>数据库重启后数据丢失</li>
<li>支持哈希索引</li>
<li>不支持事务  </li>
<li>Memory 存储引擎是不支持禁用的</li>
<li>MySQL 内部的排序操作的临时表使用该存储引擎</li>
<li>参数 max_heap_table_size 决定使用的大小<ul>
<li>默认的大小：16M</li>
</ul>
</li>
<li>内存放不下的转为MyISAM表<ul>
<li>注意临时路径空间大小</li>
</ul>
</li>
<li>内除使用为会话级别<ul>
<li>小心 OOM</li>
</ul>
</li>
</ul>
<table>
<thead>
<tr>
<th>Feature</th>
<th>Support</th>
</tr>
</thead>
<tbody><tr>
<td>B-tree indexes</td>
<td>Yes</td>
</tr>
<tr>
<td>Backup/point-in-time recovery (Implemented in the server, rather than in the storage engine.)</td>
<td>Yes</td>
</tr>
<tr>
<td>Cluster database support</td>
<td>No</td>
</tr>
<tr>
<td>Clustered indexes</td>
<td>No</td>
</tr>
<tr>
<td>Compressed data</td>
<td>No</td>
</tr>
<tr>
<td>Data caches</td>
<td>N/A</td>
</tr>
<tr>
<td>Encrypted data</td>
<td>Yes (Implemented in the server via encryption functions.)</td>
</tr>
<tr>
<td>Foreign key support</td>
<td>No</td>
</tr>
<tr>
<td>Full-text search indexes</td>
<td>No</td>
</tr>
<tr>
<td>Geospatial data type support</td>
<td>No</td>
</tr>
<tr>
<td>Geospatial indexing support</td>
<td>No</td>
</tr>
<tr>
<td>Hash indexes</td>
<td>Yes</td>
</tr>
<tr>
<td>Index caches</td>
<td>N/A</td>
</tr>
<tr>
<td>Locking granularity</td>
<td>Table</td>
</tr>
<tr>
<td>MVCC</td>
<td>No</td>
</tr>
<tr>
<td>Replication support (Implemented in the server, rather than in the storage engine.)</td>
<td>Limited</td>
</tr>
<tr>
<td>Storage limits</td>
<td>RAM</td>
</tr>
<tr>
<td>T-tree indexes</td>
<td>No</td>
</tr>
<tr>
<td>Transactions</td>
<td>No</td>
</tr>
<tr>
<td>Update statistics for data dictionary</td>
<td>Yes</td>
</tr>
</tbody></table>
</li>
<li><p>Federated</p>
<ul>
<li>运行本地访问远程 MySQL 数据库中表的数据</li>
<li>本地不存储任何数据文件</li>
<li>类似 Oracle 中的透明网关<ul>
<li>仅支持 Mysql =&gt; MySQL 的访问</li>
<li>不支持异构数据库的访问</li>
</ul>
</li>
<li>Federrated 存储引擎默认不开启<ul>
<li>配置文件：federated</li>
</ul>
</li>
<li>异构数据库远程访问<ul>
<li>MariaDB ：FederatedX 支持 ODBC 的方式访问异构数据库<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># example:</span><br><span class="line">scheme:<span class="operator">/</span><span class="operator">/</span>user_name[password]<span class="variable">@host</span>_name[:port_num]<span class="operator">/</span>db_name<span class="operator">/</span>tbl_name</span><br><span class="line">CONNECTION<span class="operator">=</span><span class="string">&#x27;mysql://username:password@hostname:port/database/tablename&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">&#x27;T1&#x27;</span>(</span><br><span class="line">    <span class="string">&#x27;A&#x27;</span> <span class="type">VARCHAR</span>(<span class="number">100</span>),</span><br><span class="line">    <span class="keyword">UNIQUE</span> KEY(<span class="string">&#x27;A&#x27;</span>(<span class="number">30</span>))</span><br><span class="line">) ENGINE <span class="operator">=</span> FEDERATED</span><br><span class="line">CONNECTION<span class="operator">=</span><span class="string">&#x27;MYSQL://ROOT:123@127.0.0.1:3306/TEST/T1&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p>CSV</p>
<ul>
<li>Comma Separated Values</li>
<li>CSV 是一种标准文件格式</li>
<li>文件以纯文本形式存储表格数据</li>
<li>不支持特殊字符</li>
<li>使用相当广泛<ul>
<li>mysql 数据库中 slow_log 表和 general_log 表使用的就是用的CSV存储引擎  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">(root<span class="variable">@localhost</span>) <span class="operator">&gt;</span> [mysql]<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> slow_log\G</span><br><span class="line">       <span class="keyword">Table</span>: slow_log</span><br><span class="line"><span class="keyword">Create</span> <span class="keyword">Table</span>: <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `slow_log` (</span><br><span class="line"> `start_time` <span class="type">timestamp</span>(<span class="number">6</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="built_in">CURRENT_TIMESTAMP</span>(<span class="number">6</span>) <span class="keyword">ON</span> UPDATE <span class="built_in">CURRENT_TIMESTAMP</span>(<span class="number">6</span>),</span><br><span class="line"> `user_host` mediumtext <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> `query_time` <span class="type">time</span>(<span class="number">6</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`lock_time` <span class="type">time</span>(<span class="number">6</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line"> `rows_sent` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`rows_examined` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`db` <span class="type">varchar</span>(<span class="number">512</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`last_insert_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`insert_id` <span class="type">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`server_id` <span class="type">int</span>(<span class="number">10</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`sql_text` mediumblob <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">`thread_id` <span class="type">bigint</span>(<span class="number">21</span>) unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span></span><br><span class="line">    ) ENGINE<span class="operator">=</span>CSV <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8 COMMENT<span class="operator">=</span><span class="string">&#x27;Slow log&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
<li><p>Archive</p>
<ul>
<li>是无法在 OLTP 类的应用中所使用的，因为它不支持对数据的修改，而OLTP中一定会对数据进行修改，对于一些数据仓库的应用，或者一些特殊的表，如：记录日志类的表或者数据采集的表，由于会要存储大量的数据，就比较适合 Archive 存储引擎，存储空间占用最小。</li>
</ul>
</li>
</ul>
</li>
<li><p>第三方存储引擎</p>
<ul>
<li>TokuDB<ul>
<li>插入密集型可以用</li>
</ul>
</li>
<li>Spider<ul>
<li>分布式中间件</li>
</ul>
</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/08/17/Mysql-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/" data-id="cksj3e1jg0005m4w00g5b876d" data-title="Mysql-存储引擎" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-日志" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/17/Mysql-%E6%97%A5%E5%BF%97/" class="article-date">
  <time class="dt-published" datetime="2021-08-17T08:24:09.000Z" itemprop="datePublished">2021-08-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/17/Mysql-%E6%97%A5%E5%BF%97/">Mysql-日志</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="MySQL日志"><a href="#MySQL日志" class="headerlink" title="MySQL日志"></a>MySQL日志</h4><p>Quick Viewing  </p>
<ol>
<li><a href="#p2">慢查询日志</a></li>
<li><a href="#p2">错误日志</a></li>
</ol>
<h4 id="慢查询日志"><a href="#慢查询日志" class="headerlink" title="慢查询日志"></a>慢查询日志</h4><ul>
<li>将运行超过某个阈值的SQL语句记录到文件<ul>
<li>慢查询</li>
<li>默认名:机器名-slow.log</li>
</ul>
</li>
<li>Mysql-5.1 开始可以以毫秒为单位记录运行的SQL语句</li>
<li>Mysql-5.5 开始可以将慢查询保存到表</li>
<li>Mysql-5.6 开始可以更细粒度的记录慢查询</li>
<li>Mysql-5.7 可以将时区信息保写入到慢查询日志</li>
</ul>
<h4 id="慢查询日志相关参数"><a href="#慢查询日志相关参数" class="headerlink" title="慢查询日志相关参数"></a>慢查询日志相关参数</h4><table>
<thead>
<tr>
<th>参数</th>
<th>说明</th>
<th>版本说明</th>
</tr>
</thead>
<tbody><tr>
<td>slow_query_log</td>
<td>是否开启慢查询日志</td>
<td></td>
</tr>
<tr>
<td>slow_query_log_file</td>
<td>慢查询日志文件名</td>
<td></td>
</tr>
<tr>
<td>long_query_time</td>
<td>指定慢查询阈值</td>
<td>5.5后毫秒支持</td>
</tr>
<tr>
<td>min_examined_row_limit</td>
<td>扫描记录少于该值的SQL语句不记录到慢查询日志</td>
<td></td>
</tr>
<tr>
<td>log-queries-not-using-indexes</td>
<td>将没有使用索引的SQL语句记录到慢查询日志</td>
<td></td>
</tr>
<tr>
<td>log_throttle_queries_not_using_indexes</td>
<td>显示每分钟记录没有使用索引的SQL语句的次数</td>
<td>5.6</td>
</tr>
<tr>
<td>log-slow-admin-statement</td>
<td>记录管理操作，如ALTER/ANALYZE TABLE</td>
<td></td>
</tr>
<tr>
<td>log_output</td>
<td>慢查询日志的格式，{FILE&amp;#124TABLE&amp;#124NONE}</td>
<td>5.5</td>
</tr>
<tr>
<td>log_slow_slave_statements</td>
<td>在从服务器上开启慢查询日志</td>
<td></td>
</tr>
<tr>
<td>log_timestamps</td>
<td>写入时区信息</td>
<td>5.6</td>
</tr>
</tbody></table>
<h4 id="tips"><a href="#tips" class="headerlink" title="tips"></a>tips</h4><ol>
<li>线上业务的慢查询日志清理</li>
</ol>
<ul>
<li>线上产生的慢查询日志太多，或者太大的时候就需要清理啦</li>
<li>使用bash &gt; echo ‘ ‘ &gt; slow.log 或者 bash &gt; &gt; slow.log 的方法清空日志文件是不对的，无效的。因为MySQL已经打开了slow.log文件的句柄，如果当前还有慢查询写入，还是对当前文件生效的，而且文件所占空间不会被释放。</li>
<li>正确的做法如下<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份或删除</span></span><br><span class="line">cp slow.log /path/slow.log.bak</span><br><span class="line">rm slow.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 在mysql中执行刷新slow logs，重新打开文件句柄，会在path/下重新生成一个slow.log文件</span></span><br><span class="line">1. mysql -u root -p</span><br><span class="line">2. flush slow logs;</span><br></pre></td></tr></table></figure></li>
</ul>
<ol start="2">
<li>下面的情况的慢查询记录不会记录到日志中</li>
</ol>
<ul>
<li><p>在并发操作一个字段的情况下，线程 1 的语句没有释放锁，同时线程 2 的 语句操作该字段</p>
</li>
<li><p>所以说 slow_log 实际上记录的是(Query_time - Lock_time) 大于 long_query_time 阈值 的SQL语句</p>
<h4 id="错误日志"><a href="#错误日志" class="headerlink" title="错误日志"></a>错误日志</h4></li>
<li><p>参数：log_error</p>
<ul>
<li>默认名:机器名.err</li>
<li>建议统一修改成一个固定的文件名，例如mysql.err<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">log_error = mysql.err</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>可以将配置错误日志记录到系统日志中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[mysqld_safe]</span><br><span class="line">syslog</span><br><span class="line">syslog_tag = stock #mysqld_stock </span><br></pre></td></tr></table></figure>
<h4 id="通用日志"><a href="#通用日志" class="headerlink" title="通用日志"></a>通用日志</h4></li>
<li><p>可以记录数据库所有相关操作</p>
<ul>
<li>参数 general_log </li>
<li>默认文件名: 机器名.log</li>
</ul>
</li>
<li><p>同样可以将日志保存到表</p>
<ul>
<li>mysql.general_log</li>
</ul>
</li>
<li><p>开启性能明显下降，大约损失50%的性能，使用与否，取决具体需求</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/08/17/Mysql-%E6%97%A5%E5%BF%97/" data-id="cksj3e1jo000dm4w02wnz5jpc" data-title="Mysql-日志" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-多实例" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/08/07/Mysql-%E5%A4%9A%E5%AE%9E%E4%BE%8B/" class="article-date">
  <time class="dt-published" datetime="2021-08-07T09:50:50.000Z" itemprop="datePublished">2021-08-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/08/07/Mysql-%E5%A4%9A%E5%AE%9E%E4%BE%8B/">Mysql-多实例</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/08/07/Mysql-%E5%A4%9A%E5%AE%9E%E4%BE%8B/" data-id="cksj3e1jk0008m4w04mx6ahr7" data-title="Mysql-多实例" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-配置文件" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/31/Mysql-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/" class="article-date">
  <time class="dt-published" datetime="2021-07-31T11:19:06.000Z" itemprop="datePublished">2021-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/31/Mysql-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/">MySQL-配置文件</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/07/31/Mysql-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6/" data-id="cksj3e1jt000jm4w09fan3n3x" data-title="MySQL-配置文件" class="article-share-link">Share</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-用户权限管理" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/31/Mysql-%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" class="article-date">
  <time class="dt-published" datetime="2021-07-30T22:27:27.000Z" itemprop="datePublished">2021-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/31/Mysql-%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/">Mysql-用户和权限管理</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="MySQL用户和权限管理"><a href="#MySQL用户和权限管理" class="headerlink" title="MySQL用户和权限管理"></a>MySQL用户和权限管理</h4><p>Quick Viewing  </p>
<ol>
<li><a href="#p2">创建账户</a></li>
</ol>
<h4 id="用户管理"><a href="#用户管理" class="headerlink" title="用户管理"></a>用户管理</h4><ul>
<li>创建账户  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">USER</span> user_specification[user_specification]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">user_specification:</span><br><span class="line">  <span class="keyword">user</span>[identified_option]</span><br><span class="line"></span><br><span class="line">identified_option:&#123;</span><br><span class="line">    IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;auth_string&#x27;</span> <span class="operator">|</span> IDENTIFIED <span class="keyword">BY</span> PASSWORD <span class="string">&#x27;hash_string&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">example:</span><br><span class="line">  # 创建一个允许在 <span class="string">&#x27;192.168.0&#x27;</span> 网段登录的账户 DEV 密码为 <span class="number">123</span></span><br><span class="line">  <span class="keyword">CREATE</span> <span class="keyword">USER</span> <span class="string">&#x27;DEV&#x27;</span>@<span class="string">&#x27;192.168.0.%&#x27;</span> IDENTIFIED <span class="keyword">BY</span> <span class="string">&#x27;123&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>删除账户 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="keyword">user</span>[<span class="keyword">user</span>] ....</span><br><span class="line"></span><br><span class="line">example:</span><br><span class="line">    <span class="keyword">DROP</span> <span class="keyword">USER</span> <span class="string">&#x27;DEV&#x27;</span>@<span class="string">&#x27;192.168.0.%&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>修改账户 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">RENAME <span class="keyword">USER</span> <span class="operator">&lt;</span>旧用户<span class="operator">&gt;</span> <span class="keyword">TO</span> <span class="operator">&lt;</span>新用户<span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">example:</span><br><span class="line">    # 修改账户名 DEV 为 DEV_USER 允许登录 IP 修改为 localhost</span><br><span class="line">    RENAME <span class="keyword">USER</span> <span class="string">&#x27;DEV&#x27;</span>@<span class="string">&#x27;192.168.0.%&#x27;</span> <span class="keyword">TO</span> </span><br><span class="line">    <span class="string">&#x27;DEV_USER&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure></li>
<li>查询账户 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">example:</span><br><span class="line">    # 查询所有账户</span><br><span class="line">    USE mysql</span><br><span class="line">    <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> <span class="keyword">user</span> \G</span><br></pre></td></tr></table></figure>
<h4 id="权限管理"><a href="#权限管理" class="headerlink" title="权限管理"></a>权限管理</h4><img src="https://i.loli.net/2021/07/31/Nn5ZO2mtF8QLuJy.png" alt="MySQL权限管理"></li>
<li>删除所有用户名为空的用户</li>
<li>不允许密码为空的用户存在</li>
<li>管理员用户可以有所有库权限</li>
<li>开发应用只需要给相应库的权限  </li>
</ul>
<p>常用权限</p>
<ul>
<li>SQL 语句: SELECT,INSERT,UPDATE,DELETE,INDEX</li>
<li>存储过程： CREATE ROUTINE, ALTER ROUTINE, EXECUTE, TRIGGER</li>
<li>管理权限：SUPER, RELOAD, SHOW DATABASE, SHUTDOWN, GRANT OPTION</li>
</ul>
<p>所有权限</p>
<ul>
<li>More info: <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/privileges-provided.html">Mysql-Download</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/07/31/Mysql-%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86/" data-id="cksj3e1jq000fm4w05g47a6wj" data-title="Mysql-用户和权限管理" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-02-Mysql-配置参数" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/29/02-Mysql-%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0/" class="article-date">
  <time class="dt-published" datetime="2021-07-29T12:25:54.000Z" itemprop="datePublished">2021-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/29/02-Mysql-%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0/">02-Mysql 配置参数</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="MySQL-配置参数"><a href="#MySQL-配置参数" class="headerlink" title="MySQL 配置参数"></a>MySQL 配置参数</h4><ul>
<li>从作用域可分为 global 和 session <a id="p1"><a href="#p1">_p1</a></a></li>
<li>从类型上又可分为可 <strong>修改</strong> 和只 <strong>可读</strong> <a id="p2"><a href="#p2">_p2</a></a></li>
<li>用户可以在线修改非只读参数 <a id="p3"><a href="#p3">_p3</a></a></li>
<li>只读参数只能通过配置文件修改并重启 </li>
<li>所参数的修改都不持久化  <a id="p4"><a href="#p4">_p4</a></a></li>
</ul>
<table>
<thead>
<tr>
<th>命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>show [global &amp;#124 session ] variables[like ‘pattern’ &amp;#124 where expr]</td>
<td>查看变量根据 like 过滤</td>
</tr>
<tr>
<td>set [global &amp;#124 session ] variables variables = xxx</td>
<td>修改 global 或者 session 参数</td>
</tr>
</tbody></table>
<p> <strong>NOTE :</strong> 通过 global 修改参数不会影响 session 参数   </p>
<p> <strong>实践 :</strong>  </p>
<p> <a href="#p1">p1</a><br> <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># 查看 <span class="keyword">global</span> 和 session 变量</span><br><span class="line"> <span class="keyword">show</span> &#123;<span class="keyword">global</span><span class="operator">|</span>session&#125; variables \G;</span><br></pre></td></tr></table></figure></p>
<p>  <a href="#p2">p2</a><br>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 配置文件中的参数基本都是只读变量</span><br></pre></td></tr></table></figure></p>
<p>  <a href="#p3">p3</a><br>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> # 修改 session 变量 </span><br><span class="line"><span class="keyword">set</span> long_query_time <span class="operator">=</span> <span class="number">5</span></span><br><span class="line"> # 修改 <span class="keyword">global</span> 变量</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">global</span> long_query_time <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><br>  <a href="#p4">p4</a><br>  <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"># 修改参数</span><br><span class="line"><span class="keyword">set</span> <span class="keyword">set</span> &#123;<span class="keyword">global</span><span class="operator">|</span>session&#125; long_query_time <span class="operator">=</span> <span class="number">1</span></span><br><span class="line"># 断开与服务器连接后，会恢复成默认值 mysql <span class="comment">--help --verbose</span></span><br><span class="line"><span class="keyword">show</span> &#123;<span class="keyword">global</span><span class="operator">|</span>session&#125; variables <span class="keyword">like</span> <span class="string">&#x27;long_query_time&#x27;</span></span><br><span class="line"><span class="operator">|</span> long_query_time <span class="operator">|</span> <span class="number">10.000000</span> <span class="operator">|</span></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/07/29/02-Mysql-%E9%85%8D%E7%BD%AE%E5%8F%82%E6%95%B0/" data-id="cksj3e1j30000m4w07agsfta6" data-title="02-Mysql 配置参数" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-升级" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/29/Mysql-%E5%8D%87%E7%BA%A7/" class="article-date">
  <time class="dt-published" datetime="2021-07-29T02:17:48.000Z" itemprop="datePublished">2021-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/29/Mysql-%E5%8D%87%E7%BA%A7/">Mysql 升级</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        
      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/07/29/Mysql-%E5%8D%87%E7%BA%A7/" data-id="cksj3e1je0003m4w0gezb3ann" data-title="Mysql 升级" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Mysql-基础命令" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/07/29/Mysql-%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/" class="article-date">
  <time class="dt-published" datetime="2021-07-29T02:06:10.000Z" itemprop="datePublished">2021-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/07/29/Mysql-%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/">Mysql 基础命令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>show processlist  </p>
<p>show warnings;</p>
<p>desc table;<br>查看表结构</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://owliu.github.io/2021/07/29/Mysql-%E5%9F%BA%E7%A1%80%E5%91%BD%E4%BB%A4/" data-id="cksj3e1jf0004m4w047gm0r4g" data-title="Mysql 基础命令" class="article-share-link">Share</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/mysql/" style="font-size: 10px;">mysql</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/08/">August 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">July 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/08/19/Mysql-%E8%A1%A8%E7%9A%84%E5%88%9B%E5%BB%BA%E4%B8%8E%E7%BB%B4%E6%8A%A4/">Mysql-表的创建和维护</a>
          </li>
        
          <li>
            <a href="/2021/08/17/Mysql-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/">Mysql-数据类型</a>
          </li>
        
          <li>
            <a href="/2021/08/17/Mysql-%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E/">Mysql-存储引擎</a>
          </li>
        
          <li>
            <a href="/2021/08/17/Mysql-%E6%97%A5%E5%BF%97/">Mysql-日志</a>
          </li>
        
          <li>
            <a href="/2021/08/07/Mysql-%E5%A4%9A%E5%AE%9E%E4%BE%8B/">Mysql-多实例</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Ow Liu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>